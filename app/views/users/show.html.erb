<table class="profile" summary="Profile information">
  <div class="main">
    <tr>
      <td><%= profilePicture %></td>
      <td><%= @user.name %></td>
    </tr>
    <tr>
      <%= link_to "Create Goal", newGoal_path %>
    </tr>
  </div>

  <div>
  <tr>
    <td>
      <p>My Created Goals</p>
      <% unless @goals.empty?%>
        <table class="goals" summary="User goals">
          <% @goals.each do | goal | %>
          <li><%= link_to goal.title, goal %></li> 
          <% end %>
        </table>
        <%= will_paginate @goals %>
      <% end %>
    </td>

    <td>
      <p>My Following Goals</p>
      <% unless @workingGoals.empty?%>
        <table class="goals" summary="Working goals">
          <% @workingGoals.each do | goal | %>
          <li><%= link_to goal.title, goal %>
            <% @userGoalRelationship = current_user.user_goal_relationships.find_by_goal_id(goal) %>
            <% doneMilestones = @userGoalRelationship.user_goal_milestone_relationships.count() %>
            <% totalMilestones = goal.milestones.count() %>
            <% if (totalMilestones == 0) %>
              <% @progress = 0 %>
            <% else %>
              <% @progress=(doneMilestones*100)/totalMilestones %>
            <% end %>
            <div class="progressbar" rel="<%=@progress%>"></div>
          </li>
          <% end %>
        </table>
        <%= will_paginate @workingGoals %>      
      <% end %>
    </td>

  </tr>
  </div>
</table>

<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
<script>
  $(document).ready(function() {
    $("div.progressbar").each (function () {
      var element = this;
      $(element).progressbar({
        value: parseInt($(element).attr("rel"))
      });
    });
  });
</script>
